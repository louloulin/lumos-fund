# LumosFund 系统架构

## 1. 总体架构

LumosFund采用了四层架构设计，将AI驱动的量化交易功能进行了清晰的分层，以实现最大化的灵活性和可扩展性：

### 1.1 工具层 (Tool Layer)

工具层提供了一系列专业化的金融分析工具，作为整个系统的基础功能单元。这些工具负责数据获取、转换、分析和处理，为上层代理提供必要的功能支持。主要工具包括：

- **市场数据工具**：获取股票价格、交易量、市值等基础市场数据
- **财务数据工具**：分析公司财务报表、估值指标和财务健康状况
- **技术分析工具**：计算各类技术指标（如RSI、MACD、布林带等）和图表模式
- **新闻情绪工具**：分析新闻报道和社交媒体对股票的情绪影响
- **因子模型工具**：实现多因子模型分析和策略构建
- **统计套利工具**：寻找配对交易和统计套利机会
- **创新评估工具**：评估公司的创新能力和技术领先性
- **收入分析工具**：分析公司的收入增长模式和质量

### 1.2 代理层 (Agent Layer)

代理层基于工具层提供的功能，实现了一系列专业化的投资"智能体"，每个代理代表不同的投资风格或专业领域。核心代理包括：

- **价值投资代理**：遵循Warren Buffett的投资哲学，专注于寻找被低估的优质企业
- **成长投资代理**：采用Peter Lynch的投资方法，关注高增长潜力的公司
- **趋势投资代理**：基于技术分析和市场动量，追踪价格趋势
- **量化投资代理**：利用统计套利和多因子模型进行系统化投资
- **风险管理代理**：评估投资组合风险并提供风控建议
- **情绪分析代理**：分析市场情绪对股票价格的影响
- **宏观分析代理**：评估宏观经济环境对市场的影响
- **技术分析代理**：提供深度技术面分析
- **投资委员会代理**：综合各个专业代理的建议，形成最终决策
- **策略推荐代理**：基于用户风险偏好提供个性化策略建议

### 1.3 工作流层 (Workflow Layer)

工作流层将多个代理组合成端到端的决策流程，实现完整的投资决策链。主要工作流包括：

- **交易决策工作流**：整合多个代理的分析结果，生成最终交易决策
- **股票分析工作流**：提供股票的全面分析报告
- **投资组合优化工作流**：优化资产配置和风险收益特性
- **市场扫描工作流**：寻找符合特定标准的投资机会

### 1.4 API层 (API Layer)

API层为前端应用提供了统一的接口，使客户端能够方便地与后端系统进行交互。主要API包括：

- **分析API**：提供股票和市场分析功能
- **投资组合API**：管理用户投资组合
- **交易API**：执行交易决策
- **用户偏好API**：管理用户的投资偏好设置

## 2. 技术栈架构

LumosFund采用了现代化的全栈技术架构：

### 2.1 前端技术栈

- **Next.js**：提供服务端渲染和静态生成的React框架
- **TypeScript**：强类型编程语言，提高代码质量和开发效率
- **Tailwind CSS**：实用优先的CSS框架，用于构建响应式界面
- **ShadcnUI**：基于Tailwind的组件库，提供美观的UI组件

### 2.2 后端技术栈

- **Node.js**：JavaScript运行环境
- **Next.js API Routes**：提供API功能
- **TypeScript**：类型安全保障
- **Mastra AI框架**：实现AI代理系统
- **Qwen AI**：提供大模型智能支持

### 2.3 AI框架架构

- **Mastra Core**：代理系统的核心框架
- **代理系统**：基于LLM的专业化AI代理
- **记忆系统**：实现对话和上下文记忆
- **工具集成**：连接外部数据源和分析功能

### 2.4 数据架构

- **市场数据**：股票价格、交易量等实时和历史市场数据
- **财务数据**：公司财务报表、估值指标等基础财务数据
- **新闻数据**：新闻报道、社交媒体信息等情绪数据
- **用户数据**：用户偏好、投资组合、交易历史等个人数据

## 3. 模块依赖关系

LumosFund系统的模块间存在明确的依赖关系，确保了系统的可维护性和扩展性：

```
前端应用
  └── API层
      └── 工作流层
          └── 代理层
              └── 工具层
                  └── 数据源
```

这种层次化的依赖结构使得每一层只需要关注直接相邻的上下层，从而减少了系统的耦合度。

## 4. 扩展架构

LumosFund的架构设计支持多种扩展方式：

### 4.1 水平扩展

- **新增代理**：添加新的投资风格或专业领域的AI代理
- **新增工具**：开发更多专业分析工具
- **新增工作流**：设计新的决策流程

### 4.2 垂直扩展

- **增强现有代理**：提升现有代理的专业能力和智能水平
- **优化工具性能**：提高数据处理和分析的效率和精度
- **改进工作流逻辑**：优化决策流程的合理性和有效性

### 4.3 集成扩展

- **接入更多数据源**：集成更多专业金融数据提供商
- **增加交易执行渠道**：连接更多券商和交易平台
- **对接外部系统**：与其他金融科技系统进行集成 